#!/bin/bash

selection=$(echo -e "Û±êã  zen mode\nÛ∞éÅ  movie mode\nÓ´í  normal mode\nÛ∞ã∞  grayscale mode\nÛ∞¥Ö  blue light filter mode\nÛ∞â¶  vibrant mode" | rofi -dmenu -p "Ôíè    modes")

zen_mode() {
  hyprctl keyword decoration:rounding 0
  hyprctl keyword general:border_size 0
  hyprctl keyword general:gaps_in 0
  hyprctl keyword general:gaps_out 0
}

movie_mode() {
  hyprctl keyword decoration:rounding 0
  hyprctl keyword general:border_size 0
  hyprctl keyword general:gaps_in 0
  hyprctl keyword general:gaps_out 0

  hyprctl hyprpaper preload "$HOME/img/wal/solid-black.png"
  hyprctl hyprpaper wallpaper "eDP-1,$HOME/img/wal/solid-black.png"
  hyprctl hyprpaper wallpaper "HDMI-A-1,$HOME/img/wal/solid-black.png"

  if [ ! -f "/tmp/waybar_toggle.dat" ]; then
    waybar_toggle=1
    echo "${waybar_toggle}" >/tmp/waybar_toggle.dat
  else
    waybar_toggle=$(cat /tmp/waybar_toggle.dat)
  fi

  if [[ $waybar_toggle -eq 1 ]]; then
    pkill -SIGUSR1 waybar
    waybar_toggle=0
    echo "${waybar_toggle}" >/tmp/waybar_toggle.dat
  fi
}

normal_mode() {
  hyprctl reload
  hyprctl hyprpaper wallpaper "HDMI-A-1, ~/img/.wallpaper_big.png"
  hyprctl hyprpaper wallpaper "eDP-1, ~/img/.wallpaper_small.png"

  if [ ! -f "/tmp/waybar_toggle.dat" ]; then
    waybar_toggle=1
    echo "${waybar_toggle}" >/tmp/waybar_toggle.dat
  else
    waybar_toggle=$(cat /tmp/waybar_toggle.dat)
  fi

  if [[ $waybar_toggle -eq 0 ]]; then
    pkill -SIGUSR1 waybar
    waybar_toggle=1
    echo "${waybar_toggle}" >/tmp/waybar_toggle.dat
  fi
}

grayscale_mode() {
  # Apply grayscale shader
  hyprctl keyword decoration:blur false
  hyprctl keyword decoration:screen_shader "$HOME/.config/hypr/shaders/grayscale.frag"
}

bluelight_filter() {
  hyprctl keyword decoration:blur false
  hyprctl keyword decoration:screen_shader "$HOME/.config/hypr/shaders/blfilter.frag"
}

vibrant_mode() {
  hyprctl keyword decoration:blur false
  hyprctl keyword decoration:screen_shader "$HOME/.config/hypr/shaders/vibrance.frag"
}

case $selection in
"Û±êã  zen mode")
  zen_mode && dunstify -a "modes" -r 2903 -i crosshairs "zen" "start focusing on your task!"
  ;;
"Û∞éÅ  movie mode")
  movie_mode && dunstify -a "modes" -r 2903 -i filmgrain "movie" "enjoy your movie! üçø"
  ;;
"Ó´í  normal mode")
  normal_mode && dunstify -a "modes" -r 2903 -i reply "default" "back to default."
  ;;
"Û∞ã∞  grayscale mode")
  grayscale_mode && dunstify -a "modes" -r 2903 -i edit-select-invert "grayscale" "b&w forever."
  ;;
"Û∞¥Ö  blue light filter mode")
  bluelight_filter && dunstify -a "modes" -r 2903 -i redeyes "blue light filter" "protect your eyes."
  ;;
"Û∞â¶  vibrant mode")
  vibrant_mode && dunstify -a "modes" -r 2903 -i color-fill "vibrant" "colorful colors."
  ;;
esac
